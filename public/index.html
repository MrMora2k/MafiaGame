<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ูุงููุง - ุงูุทุงููุฉ ุงููุณุชุฏูุฑุฉ</title>
    <meta name="description" content="ูุนุจุฉ ูุงููุง ุฌูุงุนูุฉ ูุจุงุดุฑุฉ ูุน ูุงุฌูุฉ ุงูุทุงููุฉ ุงููุณุชุฏูุฑุฉ">

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#7c5ef5">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ูุงููุง">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/images/icon-192.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/images/icon-192.png">
    <link rel="icon" type="image/svg+xml" href="/images/icon.svg">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700;900&family=Tajawal:wght@400;500;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div id="app">
        <!-- Background Effects -->
        <div class="bg-effects">
            <div class="bg-gradient"></div>
            <div class="bg-noise"></div>
            <div class="particles">
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
            </div>
        </div>
        <!-- Main Game Content -->
        <main class="main-content">
            <!-- ==================== AUTH SCREEN ==================== -->
            <section id="auth-screen" class="screen active">
                <div class="auth-box">
                    <div class="game-logo">
                        <h1 class="game-title">๐ญ ูุงููุง</h1>
                        <p class="game-subtitle">ุณุฌู ุฏุฎููู ููุทุงููุฉ ุงููุณุชุฏูุฑุฉ</p>
                    </div>

                    <div class="auth-tabs">
                        <button class="auth-tab active" id="tab-login">ุฏุฎูู</button>
                        <button class="auth-tab" id="tab-register">ุชุณุฌูู</button>
                    </div>

                    <form id="auth-form" class="auth-form-box">
                        <div class="input-group">
                            <label>ุงุณู ุงููุณุชุฎุฏู</label>
                            <input type="text" id="auth-username" required placeholder="ุงุฏุฎู ุงุณูู ููุง..."
                                autocomplete="username">
                        </div>
                        <div class="input-group">
                            <label>ูููุฉ ุงููุฑูุฑ</label>
                            <input type="password" id="auth-password" required placeholder="******"
                                autocomplete="current-password">
                        </div>
                        <button type="submit" id="auth-submit-btn" class="btn btn-primary w-full">ุฏุฎูู</button>
                    </form>

                    <p id="auth-error" class="error-message hidden"></p>
                </div>
            </section>

            <!-- ==================== LOBBY SCREEN ==================== -->
            <section id="lobby-screen" class="screen">
                <div class="lobby-container">
                    <header class="lobby-header">
                        <div class="header-left">
                            <h1 class="game-title-small">๐ญ ูุงููุง</h1>
                        </div>
                        <div class="header-right">
                            <button class="btn btn-icon-text" id="profile-btn">
                                <span class="icon">๐ค</span>
                                <span id="header-username">ุงุณู ุงููุณุชุฎุฏู</span>
                            </button>
                            <button class="btn btn-icon-text" id="header-logout-btn" title="ุชุณุฌูู ุงูุฎุฑูุฌ">
                                <span class="icon">๐ช</span>
                            </button>
                        </div>
                    </header>

                    <!-- Create/Join/Browse Toggle -->
                    <div class="lobby-tabs">
                        <button class="tab-btn active" data-tab="create">ุฅูุดุงุก ุบุฑูุฉ</button>
                        <button class="tab-btn" data-tab="join">ุงูุงูุถูุงู</button>
                        <button class="tab-btn" data-tab="browse">ุงูุบุฑู ุงููุชุงุญุฉ</button>
                    </div>

                    <!-- Create Room Form -->
                    <div class="lobby-form" id="create-form">
                        <button class="btn btn-primary btn-large" id="create-btn">ุจุฏุก ุบุฑูุฉ ุฌุฏูุฏุฉ ๐</button>
                    </div>

                    <!-- Join Room Form -->
                    <div class="lobby-form hidden" id="join-form">
                        <div class="input-group">
                            <label for="room-code">ููุฏ ุงูุบุฑูุฉ</label>
                            <input type="text" id="room-code" placeholder="XXXXXX" maxlength="6" autocomplete="off"
                                style="text-transform: uppercase; text-align: center; font-size: 2rem; letter-spacing: 0.5rem;">
                        </div>
                        <button class="btn btn-primary w-full" id="join-btn">ุงูุถูุงู ุงูุขู</button>
                    </div>

                    <!-- Browse Public Rooms -->
                    <div class="lobby-form hidden" id="browse-form">
                        <div class="public-rooms-list">
                            <div class="list-header">
                                <h3>๐ ุงูุบุฑู ุงูุนุงูุฉ</h3>
                                <button class="btn btn-small" id="refresh-rooms-btn">ุชุญุฏูุซ ๐</button>
                            </div>
                            <div id="rooms-list" class="rooms-list">
                                <p class="no-rooms">ูุง ุชูุฌุฏ ุบุฑู ูุชุงุญุฉ ุญุงููุงู</p>
                            </div>
                        </div>
                    </div>

                    <!-- Error Message -->
                    <div class="error-message hidden" id="lobby-error"></div>
                </div>
            </section>

            <!-- ==================== WAITING ROOM ==================== -->
            <section id="waiting-screen" class="screen">
                <div class="waiting-container">
                    <div class="room-info">
                        <h2>ููุฏ ุงูุบุฑูุฉ</h2>
                        <div class="room-code-display" id="display-room-code">------</div>
                        <button class="btn btn-small" id="copy-code-btn">ูุณุฎ ุงูููุฏ</button>
                    </div>

                    <div class="players-waiting">
                        <h3>ุงููุงุนุจูู (<span id="player-count">0</span>/<span id="max-players">12</span>)</h3>
                        <ul class="player-list" id="player-list"></ul>
                        <p class="min-players-note">ูุฌุจ ูุฌูุฏ 4 ูุงุนุจูู ุนูู ุงูุฃูู ููุจุฏุก</p>
                    </div>

                    <!-- Settings Panel (Host Only) -->
                    <div class="settings-panel hidden" id="settings-panel">
                        <h3>โ๏ธ ุฅุนุฏุงุฏุงุช ุงููุนุจุฉ</h3>
                        <div class="settings-grid">
                            <div class="setting-item">
                                <label>ุฃูุตู ุนุฏุฏ ูุงุนุจูู</label>
                                <select id="setting-max-players">
                                    <option value="4">4</option>
                                    <option value="6">6</option>
                                    <option value="8">8</option>
                                    <option value="10">10</option>
                                    <option value="12" selected>12</option>
                                    <option value="14">14</option>
                                    <option value="16">16</option>
                                    <option value="18">18</option>
                                    <option value="20">20</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <label>ุนุฏุฏ ุงููุงููุง</label>
                                <select id="setting-mafia">
                                    <option value="0">ุชููุงุฆู</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <label>ุนุฏุฏ ุงูุฃุทุจุงุก</label>
                                <select id="setting-doctors">
                                    <option value="0">0</option>
                                    <option value="1" selected>1</option>
                                    <option value="2">2</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <label>ุนุฏุฏ ุงููุญูููู</label>
                                <select id="setting-detectives">
                                    <option value="0">0</option>
                                    <option value="1" selected>1</option>
                                    <option value="2">2</option>
                                </select>
                            </div>
                        </div>
                        <div class="setting-toggle">
                            <label class="toggle-label">
                                <input type="checkbox" id="setting-self-heal" checked>
                                <span class="toggle-switch"></span>
                                <span>ุงูุทุจูุจ ููููู ุญูุงูุฉ ููุณู</span>
                            </label>
                        </div>
                        <div class="setting-toggle">
                            <label class="toggle-label">
                                <input type="checkbox" id="setting-public">
                                <span class="toggle-switch"></span>
                                <span>๐ ุบุฑูุฉ ุนุงูุฉ (ุชุธูุฑ ูู ูุงุฆูุฉ ุงูุบุฑู)</span>
                            </label>
                        </div>
                    </div>

                    <div class="waiting-buttons">
                        <button class="btn btn-primary btn-large hidden" id="start-game-btn">ุจุฏุก ุงููุนุจุฉ</button>
                        <button class="btn btn-secondary" id="leave-room-btn">ูุบุงุฏุฑุฉ ุงูุบุฑูุฉ</button>
                    </div>
                </div>
            </section>

            <!-- ==================== ROLE REVEAL SCREEN ==================== -->
            <section id="role-screen" class="screen">
                <div class="role-reveal-container">
                    <h2>ุฏูุฑู ุงูุณุฑู</h2>
                    <p class="role-instruction">ุงุถุบุท ุนูู ุงูุจุทุงูุฉ ููุดู ุฏูุฑู. ุงุญูุธู ุฌูุฏุงู!</p>

                    <div class="card-container">
                        <div class="role-card" id="role-card">
                            <div class="card-face card-front">
                                <div class="card-pattern"></div>
                                <span class="tap-hint">ุงุถุบุท ูููุดู</span>
                            </div>
                            <div class="card-face card-back">
                                <div class="role-icon" id="role-icon">๐ญ</div>
                                <div class="role-name" id="role-name">ุงูุฏูุฑ</div>
                                <div class="role-description" id="role-description">ุงููุตู</div>
                            </div>
                        </div>
                    </div>

                    <div class="ready-section">
                        <p class="ready-status" id="ready-status">ูู ุงูุชุธุงุฑ ุงููุงุนุจูู...</p>
                        <button class="btn btn-primary" id="ready-btn" disabled>ุฃูุง ุฌุงูุฒ</button>
                    </div>
                </div>
            </section>

            <!-- Phase Transition Overlay -->
            <div class="phase-transition hidden" id="phase-transition">
                <div class="phase-transition-content">
                    <div class="phase-transition-icon" id="phase-transition-icon">๐</div>
                    <div class="phase-transition-text" id="phase-transition-text">ุงูููู ูุญู...</div>
                </div>
            </div>

            <!-- ==================== GAME SCREEN (ROUND TABLE) ==================== -->
            <section id="game-screen" class="screen">
                <!-- Phase Indicator -->
                <div class="phase-banner" id="phase-banner">
                    <span class="phase-icon">๐</span>
                    <span class="phase-text">ุงููููุฉ 1</span>
                </div>

                <!-- Round Table Container -->
                <div class="table-arena">
                    <div class="round-table">
                        <div class="table-center">
                            <div class="table-texture"></div>
                        </div>
                        <!-- Player seats will be dynamically added here -->
                        <div class="seats-container" id="seats-container"></div>
                    </div>
                </div>

                <!-- Action Panel (alive players) -->
                <div class="action-panel" id="action-panel">
                    <div class="action-title" id="action-title">ุงุฎุชุฑ ูุงุนุจุงู</div>
                    <div class="action-hint" id="action-hint">ุงุถุบุท ุนูู ูุงุนุจ ุญูู ุงูุทุงููุฉ ูุชูููุฐ ุฅุฌุฑุงุกู
                    </div>
                    <button class="btn btn-secondary" id="skip-action-btn" style="display: none;">ุชุฎุทู
                        ุงูุชุตููุช</button>
                </div>

                <!-- Spectator Banner (dead players) -->
                <div class="spectator-banner hidden" id="spectator-banner">
                    <span class="spectator-icon">๐ป</span>
                    <span class="spectator-text">ุฃูุช ูุชููู โ ุชุดุงูุฏ ุงููุนุจุฉ ููุฑุงูุจ</span>
                </div>

                <!-- Event Log Panel -->
                <div class="event-log-toggle" id="event-log-toggle">๐ ุณุฌู ุงูุฃุญุฏุงุซ</div>
                <div class="event-log hidden" id="event-log">
                    <div class="event-log-header">
                        <h3>๐ ุณุฌู ุงูุฃุญุฏุงุซ</h3>
                        <button class="btn btn-small" id="close-event-log">โ</button>
                    </div>
                    <div class="event-log-content" id="event-log-content"></div>
                </div>

                <!-- Night Result Modal -->
                <div class="modal hidden" id="night-modal">
                    <div class="modal-content">
                        <h2 id="night-result-title">ุทููุน ุงููุฌุฑ</h2>
                        <p id="night-result-text"></p>
                        <div class="round-summary" id="night-round-summary"></div>
                        <button class="btn btn-primary" id="night-continue-btn">ูุชุงุจุนุฉ</button>
                    </div>
                </div>

                <!-- Detective Investigation Card Modal -->
                <div class="modal hidden" id="detective-modal">
                    <div class="modal-content detective-result-card">
                        <h2>๐ ูุชูุฌุฉ ุงูุชุญููู</h2>
                        <div class="investigation-card" id="investigation-card">
                            <div class="investigation-target" id="investigation-target">ุงุณู ุงููุงุนุจ</div>
                            <div class="investigation-result" id="investigation-result">
                                <span class="result-icon">๐ค</span>
                                <span class="result-text">ุจุฑูุก</span>
                            </div>
                        </div>
                        <button class="btn btn-primary" id="detective-continue-btn">ูููุช</button>
                    </div>
                </div>

                <!-- Vote Result Modal -->
                <div class="modal hidden" id="vote-modal">
                    <div class="modal-content">
                        <h2 id="vote-result-title">ูุฑุงุฑ ุงููุฏููุฉ</h2>
                        <p id="vote-result-text"></p>
                        <div class="vote-breakdown" id="vote-breakdown"></div>
                        <div class="round-summary" id="vote-round-summary"></div>
                        <button class="btn btn-primary" id="vote-continue-btn">ูุชุงุจุนุฉ</button>
                    </div>
                </div>

                <!-- Profile Modal -->
                <div class="modal hidden" id="profile-modal">
                    <div class="modal-content profile-card">
                        <div class="profile-header">
                            <div class="profile-avatar">๐ค</div>
                            <h2 id="profile-username">User</h2>
                            <span class="level-badge" id="profile-level">Lv 1</span>
                        </div>

                        <div class="xp-section">
                            <div class="xp-header">
                                <span>ุงูุฎุจุฑุฉ (XP)</span>
                                <span id="xp-text">0 / 0</span>
                            </div>
                            <div class="xp-bar-container">
                                <div class="xp-bar-fill" id="xp-bar-fill" style="width: 0%"></div>
                            </div>
                        </div>

                        <div class="profile-stats-grid">
                            <div class="stat-item">
                                <span class="stat-value" id="stats-games">0</span>
                                <span class="stat-label">ุงููุจุงุฑูุงุช</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value" id="stats-wins">0</span>
                                <span class="stat-label">ุงูููุฒ</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value" id="stats-ratio">0%</span>
                                <span class="stat-label">ุงููุณุจุฉ</span>
                            </div>
                        </div>

                        <button class="btn btn-secondary w-full" id="close-profile-btn">ุฅุบูุงู</button>
                        <button class="btn btn-small w-full mt-2" id="logout-btn">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
                    </div>
                </div>
            </section>

            <!-- ==================== GAME OVER SCREEN ==================== -->
            <section id="gameover-screen" class="screen">
                <div class="gameover-container">
                    <div class="winner-banner" id="winner-banner">
                        <span class="winner-icon">๐</span>
                        <h1 id="winner-text">ุงููุตุฑ!</h1>
                    </div>
                    <p class="winner-message" id="winner-message">ุงูุชูุช ุงููุนุจุฉ</p>

                    <div class="progression-summary" id="progression-summary"></div>

                    <div class="final-roles">
                        <h3>ุฌููุน ุงููุงุนุจูู</h3>
                        <ul class="final-player-list" id="final-player-list"></ul>
                    </div>

                    <div class="gameover-buttons">
                        <button class="btn btn-primary btn-large hidden" id="play-again-btn">ุงููุนุจ ูุฌุฏุฏุงู</button>
                        <button class="btn btn-secondary btn-large" id="leave-game-btn">ูุบุงุฏุฑุฉ ุงูุบุฑูุฉ</button>
                    </div>
                </div>
            </section>
        </main>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script src="app.js"></script>
</body>

</html>